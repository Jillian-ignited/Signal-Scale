{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "CI Orchestrator Output Schema",
  "type": "object",
  "properties": {
    "weekly_report": {
      "type": "object",
      "properties": {
        "brand_mentions_overview": {
          "type": "object",
          "properties": {
            "this_window": {"type": "integer"},
            "prev_window": {"type": "integer"},
            "delta_pct": {"type": "number"}
          },
          "required": ["this_window", "prev_window", "delta_pct"]
        },
        "customer_sentiment": {
          "type": "object",
          "properties": {
            "positive": {"type": "string"},
            "negative": {"type": "string"},
            "neutral": {"type": "string"}
          },
          "required": ["positive", "negative", "neutral"]
        },
        "engagement_highlights": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "platform": {"type": "string"},
              "link": {"type": "string"},
              "why_it_matters": {"type": "string"}
            },
            "required": ["platform", "link", "why_it_matters"]
          }
        },
        "streetwear_trends": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "theme": {"type": "string"},
              "evidence": {"type": "string"},
              "hashtags": {
                "type": "array",
                "items": {"type": "string"}
              }
            },
            "required": ["theme", "evidence", "hashtags"]
          }
        },
        "competitive_mentions": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "competitor": {"type": "string"},
              "context": {"type": "string"},
              "link": {"type": "string"}
            },
            "required": ["competitor", "context", "link"]
          }
        },
        "opportunities_risks": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "type": {"enum": ["opportunity", "risk"]},
              "insight": {"type": "string"},
              "action": {"type": "string"},
              "impact": {"enum": ["high", "medium", "low"]}
            },
            "required": ["type", "insight", "action", "impact"]
          }
        }
      },
      "required": ["brand_mentions_overview", "customer_sentiment", "engagement_highlights", "streetwear_trends", "competitive_mentions", "opportunities_risks"]
    },
    "cultural_radar": {
      "type": "object",
      "properties": {
        "creators": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "creator": {"type": "string"},
              "platform": {"type": "string"},
              "profile": {"type": "string"},
              "followers": {"type": "integer"},
              "engagement_rate": {"type": "number"},
              "brand_mentioned": {"type": "boolean"},
              "content_focus": {"type": "string"},
              "recommendation": {"enum": ["seed", "collab", "monitor"]},
              "influence_score": {"type": "integer", "minimum": 0, "maximum": 100}
            },
            "required": ["creator", "platform", "profile", "followers", "engagement_rate", "brand_mentioned", "content_focus", "recommendation", "influence_score"]
          }
        },
        "top_3_to_activate": {
          "type": "array",
          "maxItems": 3,
          "items": {
            "type": "object",
            "properties": {
              "creator": {"type": "string"},
              "why": {"type": "string"},
              "action": {"enum": ["seed", "collab"]}
            },
            "required": ["creator", "why", "action"]
          }
        }
      },
      "required": ["creators", "top_3_to_activate"]
    },
    "peer_tracker": {
      "type": "object",
      "properties": {
        "scorecard": {
          "type": "object",
          "properties": {
            "dimensions": {
              "type": "array",
              "items": {"type": "string"}
            },
            "brands": {
              "type": "array",
              "items": {"type": "string"}
            },
            "scores": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "dimension": {"type": "string"},
                  "brand": {"type": "string"},
                  "score": {"type": "integer", "minimum": 0, "maximum": 10},
                  "notes": {
                    "type": "array",
                    "items": {"type": "string"}
                  }
                },
                "required": ["dimension", "brand", "score", "notes"]
              }
            }
          },
          "required": ["dimensions", "brands", "scores"]
        },
        "strengths": {
          "type": "array",
          "items": {"type": "string"}
        },
        "gaps": {
          "type": "array",
          "items": {"type": "string"}
        },
        "priority_fixes": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "fix": {"type": "string"},
              "impact": {"enum": ["high", "medium", "low"]},
              "why": {"type": "string"}
            },
            "required": ["fix", "impact", "why"]
          }
        }
      },
      "required": ["scorecard", "strengths", "gaps", "priority_fixes"]
    }
  },
  "additionalProperties": false
}

